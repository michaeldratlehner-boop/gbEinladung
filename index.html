<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>üéâ Geburtstagseinladung</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    :root{
      --bg1:#ffe29f;
      --bg2:#ffa99f;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --soft:#f3f4f6;
      --shadow:0 14px 40px rgba(0,0,0,.14);
      --radius:18px;
      --btn:#ff6f61;
      --btnText:#ffffff;
      --btn2:#111827;
      --ok:#16a34a;
      --bad:#dc2626;
    }

    html, body{
      height:100%;
      margin:0;
      padding:0;
      -webkit-text-size-adjust:100%;
      overscroll-behavior:none;
      touch-action:manipulation;
      -webkit-user-select:none;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
    }

    body{
      min-height:100vh;
      display:grid;
      place-items:center;
      background:linear-gradient(135deg, var(--bg1), var(--bg2));
      padding:20px;
    }

    .card{
      width:min(560px, 94vw);
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:28px;
      text-align:center;
    }

    h1{ margin:0 0 10px; font-size:28px; }
    h2{ margin:0 0 10px; font-size:20px; }
    p{ margin:10px 0; line-height:1.45; }
    .muted{ color:var(--muted); font-size:14px; }

    .divider{
      border:none;
      border-top:1px solid #ececec;
      margin:18px 0;
    }

    .row{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:14px;
    }

    .stat{
      background:var(--soft);
      border-radius:14px;
      padding:10px 12px;
      min-width:140px;
    }

    .btn{
      appearance:none;
      border:none;
      border-radius:14px;
      padding:14px 16px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      background:var(--btn);
      color:var(--btnText);
      width:100%;
      touch-action:manipulation;
    }

    .btn.secondary{
      background:#fff;
      color:var(--btn2);
      border:1px solid #e5e7eb;
    }

    .btn.small{
      width:auto;
      padding:12px 14px;
      font-size:15px;
    }

    .btn:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .tap{
      margin-top:12px;
      font-size:18px;
      padding:18px 16px;
    }

    .hidden{ display:none; }

    .details{
      margin:18px 0 6px;
      text-align:left;
      background:var(--soft);
      border-radius:14px;
      padding:14px 14px;
    }

    .details .line{
      display:flex;
      justify-content:space-between;
      gap:12px;
      padding:8px 6px;
      border-bottom:1px solid rgba(0,0,0,.05);
      font-size:15px;
    }
    .details .line:last-child{ border-bottom:none; }
    .details b{ font-weight:700; }

    .pill{
      display:inline-block;
      background:var(--soft);
      border-radius:999px;
      padding:6px 10px;
      font-size:13px;
      color:var(--muted);
    }

    /* Mini-"Kein Bot"-Spiel (Slider) */
    .sliderWrap{
      background:var(--soft);
      border-radius:14px;
      padding:14px;
      text-align:left;
      margin-top:10px;
    }
    .sliderTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    input[type="range"]{
      width:100%;
      height:42px; /* mobile-friendly */
      margin:0;
      touch-action:manipulation;
    }
    .status{
      font-weight:700;
      font-size:14px;
    }
    .status.ok{ color:var(--ok); }
    .status.bad{ color:var(--bad); }

    @media (max-width:420px){
      .card{ padding:22px; }
      h1{ font-size:24px; }
      .stat{ min-width:120px; }
    }
  </style>
</head>
<body>
  <main class="card" role="main">

    <!-- GAME 1: Clicker -->
    <section id="gameScreen" aria-label="Spiel 1">
      <h1>üéÆ Erst das Game, dann die Einladung</h1>
      <p class="muted">Ziel: <b><span id="targetLabel">20</span> Taps</b> in <b><span id="durationLabel">10</span> Sekunden</b>.</p>

      <div class="row" aria-label="Status">
        <div class="stat">‚è±Ô∏è Zeit: <b id="time">10</b>s</div>
        <div class="stat">‚≠ê Taps: <b id="score">0</b>/<span id="targetInline">20</span></div>
      </div>

      <div class="row" style="margin-top:16px;">
        <button id="startBtn" class="btn small" type="button">Start</button>
        <button id="resetBtn" class="btn secondary small" type="button">Reset</button>
      </div>

      <button id="tapBtn" class="btn tap" type="button" disabled>Tap! üëÜ</button>

      <p id="msg" class="muted" aria-live="polite"></p>
      <p class="muted"><span class="pill">Good Luck!</span></p>
    </section>

    <!-- INVITATION -->
    <section id="inviteScreen" class="hidden" aria-label="Einladung">
      <h1>üéÇ Geburtstagseinladung</h1>
      <p>Ich feiere Geburtstag und du bist eingeladen!</p>

      <div class="details" aria-label="Details">
        <div class="line"><span>üìÖ Datum</span><b>14. M√§rz 2026</b></div>
        <div class="line"><span>‚è∞ Uhrzeit</span><b>ab 18:00</b></div>
        <div class="line"><span>üìç Ort</span><b>Schenkenfelden</b></div>
      </div>

      <hr class="divider" />

      <div class="row">
        <!-- Wichtig: kein onclick mehr ‚Äì wird unten per JS gemacht -->
        <button id="rsvpBtn" class="btn" type="button">Zusage</button>
      </div>

      <div class="row" style="margin-top:12px;">
        <button id="playAgainBtn" class="btn secondary small" type="button">Nochmal spielen</button>
      </div>
    </section>

    <!-- GAME 2: "Kein Bot"-Mini-Spiel -->
    <section id="humanCheckScreen" class="hidden" aria-label="Spiel 2">
      <h1>üß© Mini-Check</h1>
      <p class="muted">Wie auf manchen Webseiten: Zieh den Slider bis ganz rechts, dann wird die Zusage best√§tigt.</p>

      <div class="sliderWrap">
        <div class="sliderTop">
          <span class="pill">‚û°Ô∏è bis 100 ziehen</span>
          <span id="humanStatus" class="status bad">Nicht best√§tigt</span>
        </div>

        <input id="humanSlider" type="range" min="0" max="100" value="0" aria-label="Slider bis 100" />

        <p class="muted" style="margin:10px 0 0;">
          Fortschritt: <b><span id="humanValue">0</span></b>/100
        </p>
      </div>

      <div class="row" style="margin-top:16px;">
        <button id="confirmBtn" class="btn" type="button" disabled>‚úÖ Zusage senden</button>
        <button id="backBtn" class="btn secondary small" type="button">Zur√ºck</button>
      </div>

      <p id="humanMsg" class="muted" aria-live="polite"></p>
    </section>

  </main>

  <script>
    
    // ===== Settings =====
    const TARGET = 20;
    const DURATION = 10; // seconds

    // Optional: WhatsApp-Link statt Alert (Nummer im internationalen Format ohne +)
    // Beispiel: const WHATSAPP_NUMBER = "436601234567";
    const WHATSAPP_NUMBER = "43068184496409"; // leer lassen -> Alert
    const WHATSAPP_TEXT = "Hi! Ich bin bei deiner Geburtstagsparty dabei üéâ";

    // ===== Elements =====
    const gameScreen = document.getElementById("gameScreen");
    const inviteScreen = document.getElementById("inviteScreen");
    const humanCheckScreen = document.getElementById("humanCheckScreen");

    const timeEl = document.getElementById("time");
    const scoreEl = document.getElementById("score");
    const msgEl = document.getElementById("msg");

    const startBtn = document.getElementById("startBtn");
    const resetBtn = document.getElementById("resetBtn");
    const tapBtn = document.getElementById("tapBtn");
    const playAgainBtn = document.getElementById("playAgainBtn");
    const rsvpBtn = document.getElementById("rsvpBtn");

    // Human check
    const humanSlider = document.getElementById("humanSlider");
    const humanValue = document.getElementById("humanValue");
    const humanStatus = document.getElementById("humanStatus");
    const confirmBtn = document.getElementById("confirmBtn");
    const backBtn = document.getElementById("backBtn");
    const humanMsg = document.getElementById("humanMsg");

    // Labels
    document.getElementById("targetLabel").textContent = String(TARGET);
    document.getElementById("targetInline").textContent = String(TARGET);
    document.getElementById("durationLabel").textContent = String(DURATION);

    // ===== State =====
    let timeLeft = DURATION;
    let score = 0;
    let running = false;
    let timerId = null;

    function render(){
      timeEl.textContent = String(timeLeft);
      scoreEl.textContent = String(score);
    }

    function stopTimer(){
      if (timerId !== null){
        clearInterval(timerId);
        timerId = null;
      }
    }

    function resetGame(){
      stopTimer();
      timeLeft = DURATION;
      score = 0;
      running = false;
      msgEl.textContent = "";
      startBtn.disabled = false;
      tapBtn.disabled = true;
      render();
    }

    function showOnly(screen){
      gameScreen.classList.add("hidden");
      inviteScreen.classList.add("hidden");
      humanCheckScreen.classList.add("hidden");
      screen.classList.remove("hidden");
    }

    function showInvitation(){
      showOnly(inviteScreen);
    }

    function showGame(){
      showOnly(gameScreen);
      resetGame();
    }

    function endGame(){
      running = false;
      stopTimer();
      tapBtn.disabled = true;
      startBtn.disabled = false;

      if (score >= TARGET){
        msgEl.textContent = `‚úÖ Geschafft! (${score}/${TARGET}) ‚Äî Einladung freigeschaltet.`;
        setTimeout(showInvitation, 450);
      } else {
        msgEl.textContent = `‚ùå ${score}/${TARGET}. Versuch‚Äôs nochmal!`;
      }
    }

    function startGame(){
      resetGame();
      running = true;
      startBtn.disabled = true;
      tapBtn.disabled = false;
      msgEl.textContent = `Los! ${TARGET} Taps in ${DURATION}s.`;
      render();

      timerId = setInterval(() => {
        timeLeft -= 1;
        render();
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    // ===== Game 2 helpers =====
    function resetHumanCheck(){
      humanSlider.value = "0";
      humanValue.textContent = "0";
      humanStatus.textContent = "Nicht best√§tigt";
      humanStatus.classList.remove("ok");
      humanStatus.classList.add("bad");
      confirmBtn.disabled = true;
      humanMsg.textContent = "";
    }

    function showHumanCheck(){
      resetHumanCheck();
      showOnly(humanCheckScreen);
    }

    function sendRSVP(){
      // ‚ÄûErgebnis‚Äú: WhatsApp-Link oder Alert
      if (WHATSAPP_NUMBER.trim().length > 0){
        const url = "https://wa.me/" + encodeURIComponent(WHATSAPP_NUMBER.trim())
          + "?text=" + encodeURIComponent(WHATSAPP_TEXT);
        window.location.href = url;
      } else {
        alert("Bitte sag mir per WhatsApp Bescheid üòä");
      }
      humanMsg.textContent = "‚úÖ Danke! ";
    }

    // ===== Events =====
    startBtn.addEventListener("click", startGame);
    resetBtn.addEventListener("click", resetGame);

    // Pointer events verhindern Doppeltipp-Zoom besser als click
    tapBtn.addEventListener("pointerdown", (e) => {
      e.preventDefault();
      if (!running) return;
      score += 1;
      render();
      if (score >= TARGET) endGame();
    });
    tapBtn.addEventListener("click", (e) => e.preventDefault());

    playAgainBtn.addEventListener("click", showGame);

    // Zusage -> erst Mini-"Kein Bot"-Spiel √∂ffnen
    rsvpBtn.addEventListener("click", showHumanCheck);

    // Slider-Logik
    humanSlider.addEventListener("input", () => {
      const v = Number(humanSlider.value);
      humanValue.textContent = String(v);

      if (v >= 100){
        humanStatus.textContent = "Best√§tigt";
        humanStatus.classList.remove("bad");
        humanStatus.classList.add("ok");
        confirmBtn.disabled = false;
        humanMsg.textContent = "‚úÖ Passt. Du kannst jetzt best√§tigen.";
      } else {
        humanStatus.textContent = "Nicht best√§tigt";
        humanStatus.classList.remove("ok");
        humanStatus.classList.add("bad");
        confirmBtn.disabled = true;
        humanMsg.textContent = "";
      }
    });

    confirmBtn.addEventListener("click", sendRSVP);
    backBtn.addEventListener("click", () => showOnly(inviteScreen));

    // Init
    showOnly(gameScreen);
    render();
  </script>
</body>
</html>
